
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:whc="http://www.oxygenxml.com/webhelp/components" xml:lang="en-us" lang="en-us" whc:version="22.0">
    <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta charset="UTF-8" /><meta name="copyright" content="(C) Copyright 2020" /><meta name="DC.rights.owner" content="(C) Copyright 2020" /><meta name="DC.type" content="task" /><meta name="description" content="Unpivot data that is in the crosstab/pivot format." /><meta name="DC.subject" content="Crosstab, unpivot, Pivot, Unpivot" /><meta name="keywords" content="Crosstab, unpivot, Pivot, Unpivot" /><meta name="indexterms" content="Crosstab, unpivot, Pivot, unpivot, Unpivot" /><meta name="DC.relation" scheme="URI" content="../tidydata/tidydata.html" /><meta name="prodname" content="Excel 365" /><meta name="DC.creator" content="Ben Welman" /><meta name="DC.date.created" content="2018-03-27" /><meta name="DC.date.modified" content="2020-08-31" /><meta name="DC.format" content="HTML5" /><meta name="DC.identifier" content="pivots_unpivoting" /><meta name="DC.language" content="en-US" />        
      <title>Task: Analysis population Benelux</title><!--  Generated with Oxygen version 22.1, build number 2020072823.  --><meta name="wh-path2root" content="../" /><meta name="wh-toc-id" content="pivots_unpivoting-d61e12136" /><meta name="wh-source-relpath" content="tidydata/tidydata_benelux.dita" /><meta name="wh-out-relpath" content="tidydata/tidydata_benelux.html" />
    <!-- Latest compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css" />
    
    <link rel="stylesheet" href="../oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css" />
    
    <!-- Template default styles  -->
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic-page.css?buildId=2020072823" />
    
    
    <script type="text/javascript" src="../oxygen-webhelp/lib/jquery/jquery-3.5.1.min.js"><!----></script>
    
    <script data-main="../oxygen-webhelp/app/topic-page.js" src="../oxygen-webhelp/lib/requirejs/require.js"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/light.css?buildId=2020072823" />
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-1284000-5"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments)};
        gtag('js', new Date());
        
        gtag('config', 'UA-1284000-5');
    </script>
</head>

    <body id="pivots_unpivoting" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">Jump to main content</a>
        <!-- EXM-36950 - Expand the args.hdr parameter here -->
        
        
        
        <header class="navbar navbar-default wh_header" whc:version="22.1">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <!--
                            This component will be generated when the next parameters are specified in the transformation scenario:
                            'webhelp.logo.image' and 'webhelp.logo.image.target.url'.
                            See: http://oxygenxml.com/doc/versions/17.1/ug-editor/#topics/dita_webhelp_output.html.
                    -->
                    <a href="https://softwijs.nl/" class=" wh_logo d-none d-sm-block "><img src="../LogoSW.gif" alt="  Learn Excel 365  A task oriented textbook  " /></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">Learn Excel 365</span>  <span class="ph booktitlealt">A task oriented textbook</span>  </span></a></div>
                    
                </div>
                
                <!-- The menu button for mobile devices is copied in the output only when the 'webhelp.show.top.menu' parameter is set to 'yes' -->
                <button type="button" data-target="#wh_top_menu_and_indexterms_link" id="wh_menu_mobile_button" data-toggle="collapse" class="navbar-toggler collapsed wh_toggle_button" aria-expanded="false" aria-label="Toggle menu" aria-controls="wh_top_menu_and_indexterms_link">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                <nav class=" wh_top_menu "><ul xmlns:xhtml="http://www.w3.org/1999/xhtml" role="menubar" aria-label="Menu"><li role="menuitem"><span id="preface-online-d61e271-mi" data-tocid="preface-online-d61e271" data-state="leaf" class=" topicref " data-id="preface-online"><span class="title"><a href="../common/preface-online.html">Preface</a></span></span></li><li role="menuitem" aria-haspopup="true" aria-expanded="false" class="has-children"><span id="part_excel-d61e287-mi" data-tocid="part_excel-d61e287" data-state="not-ready" class=" topicref " data-id="part_excel"><span class="title"><a href="../part_excel.html">Working with Excel</a></span></span></li><li role="menuitem" aria-haspopup="true" aria-expanded="false" class="has-children"><span id="part_analysis-d61e10722-mi" data-tocid="part_analysis-d61e10722" data-state="not-ready" class=" topicref " data-id="part_analysis"><span class="title"><a href="../part_analysis.html">Advanced Data Analysis</a></span></span></li><li role="menuitem"><span id="colofon-d61e12244-mi" data-tocid="colofon-d61e12244" data-state="leaf" class=" topicref " data-id="colofon"><span class="title"><a href="../common/colofon.html">Colofon</a></span></span></li></ul></nav>
                <div class=" wh_indexterms_link "><a href="../indexTerms.html" title="Index" aria-label="Go to index terms page"><span>Index</span></a></div>
                
            </div>
        </div>
    </div>
</header>
        
        <div class=" wh_search_input "><form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required" /><button type="submit" class="wh_search_button" aria-label="Search"><span>Search</span></button></div></form></div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md">
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol xmlns:html="http://www.w3.org/1999/xhtml" class="d-print-none"><li><span class="home"><a href="../index.html"><span>Home</span></a></span></li><li><span class="topicref" data-id="part_analysis"><span class="title"><a href="../part_analysis.html">Advanced Data Analysis</a></span></span></li><li><span class="topicref" data-id="tidydata"><span class="title"><a href="../tidydata/tidydata.html">Tidy Data</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc"></p></span></span></span></li><li class="active"><span class="topicref" data-id="pivots_unpivoting"><span class="title"><a href="../tidydata/tidydata_benelux.html">Task: Analysis population Benelux</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc">Unpivot data that is in the crosstab/pivot format.</p></span></span></span></li></ol></div>

                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        <div class=" wh_navigation_links "><span id="topic_navigation_links" class="navheader">
  </span></div>
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        <!-- Expand/Collapse publishing TOC 
                             The menu button for mobile devices is copied in the output only when the publication TOC is available
                        -->
                        <button type="button" data-target="#wh_publication_toc" id="wh_toc_button" data-toggle="collapse" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                </nav>
            </div>

            <div class="wh_content_area">
                <div class="row">
                    
                        <nav role="navigation" id="wh_publication_toc" class="collapse col-lg-3 col-md-3 col-sm-12 d-md-block">
                            <div class=" wh_publication_toc " data-tooltip-position="right"><ul role="tree" aria-label="Table of Contents"><span class="expand-button-action-labels"><span id="button-expand-action" aria-label="Expand"></span><span id="button-collapse-action" aria-label="Collapse"></span><span id="button-pending-action" aria-label="Pending"></span></span><li role="treeitem" aria-expanded="true"><span data-tocid="part_analysis-d61e10722" class="topicref" data-id="part_analysis" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action part_analysis-d61e10722-link" class="wh-expand-btn"></span><span class="title"><a href="../part_analysis.html" id="part_analysis-d61e10722-link">Advanced Data Analysis</a></span></span><ul role="group" class="navbar-nav nav-list"><span class="expand-button-action-labels"><span id="button-expand-action" aria-label="Expand"></span><span id="button-collapse-action" aria-label="Collapse"></span><span id="button-pending-action" aria-label="Pending"></span></span><li role="treeitem" aria-expanded="false"><span data-tocid="import-d61e11003" class="topicref" data-id="import" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action import-d61e11003-link" class="wh-expand-btn"></span><span class="title"><a href="../import/import.html" id="import-d61e11003-link">Importing data</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc"></p></span></span></span></li><li role="treeitem" aria-expanded="false"><span data-tocid="forecasts-d61e11426" class="topicref" data-id="forecasts" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action forecasts-d61e11426-link" class="wh-expand-btn"></span><span class="title"><a href="../forecasts/forecasts.html" id="forecasts-d61e11426-link">Forecasting and Time series</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc"></p></span></span></span></li><li role="treeitem" aria-expanded="true"><span data-tocid="tidydata-d61e12050" class="topicref" data-id="tidydata" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tidydata-d61e12050-link" class="wh-expand-btn"></span><span class="title"><a href="../tidydata/tidydata.html" id="tidydata-d61e12050-link">Tidy Data</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc"></p></span></span></span><ul role="group" class="navbar-nav nav-list"><span class="expand-button-action-labels"><span id="button-expand-action" aria-label="Expand"></span><span id="button-collapse-action" aria-label="Collapse"></span><span id="button-pending-action" aria-label="Pending"></span></span><li role="treeitem"><span data-tocid="tidydata_over-d61e12067" class="topicref" data-id="tidydata_over" data-state="leaf"><span role="button" class="wh-expand-btn"></span><span class="title"><a href="../tidydata/tidydata_over.html" id="tidydata_over-d61e12067-link">What is Tidy Data?</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc">Conditions that tidy data must meet.</p></span></span></span></li><li role="treeitem"><span data-tocid="tidydata_headervalues-d61e12085" class="topicref" data-id="tidydata_headervalues" data-state="leaf"><span role="button" class="wh-expand-btn"></span><span class="title"><a href="../tidydata/tidydata_headervalues.html" id="tidydata_headervalues-d61e12085-link">Task: Variable values in column headers</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc"></p></span></span></span></li><li role="treeitem"><span data-tocid="tidydata_combinedvariables-d61e12102" class="topicref" data-id="tidydata_combinedvariables" data-state="leaf"><span role="button" class="wh-expand-btn"></span><span class="title"><a href="../tidydata/tidydata_combinedvariables.html" id="tidydata_combinedvariables-d61e12102-link">Task: Combination of variables in a column</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc"></p></span></span></span></li><li role="treeitem"><span data-tocid="tidydata_tidydata_rowcolumnvariables-d61e12119" class="topicref" data-id="tidydata_tidydata_rowcolumnvariables" data-state="leaf"><span role="button" class="wh-expand-btn"></span><span class="title"><a href="../tidydata/tidydata_rowcolumnvariables.html" id="tidydata_tidydata_rowcolumnvariables-d61e12119-link">Task: Variables in both rows and columns</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc"></p></span></span></span></li><li role="treeitem" class="active"><span data-tocid="pivots_unpivoting-d61e12136" class="topicref" data-id="pivots_unpivoting" data-state="leaf"><span role="button" class="wh-expand-btn"></span><span class="title"><a href="../tidydata/tidydata_benelux.html" id="pivots_unpivoting-d61e12136-link">Task: Analysis population Benelux</a><span class="wh-tooltip"><p xmlns:toc="http://www.oxygenxml.com/ns/webhelp/toc" xmlns:xhtml="http://www.w3.org/1999/xhtml" class="shortdesc">Unpivot data that is in the crosstab/pivot format.</p></span></span></span></li><li role="treeitem" aria-expanded="false"><span data-tocid="tocId-d61e12185" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d61e12185-link" class="wh-expand-btn"></span><span class="title"><a href="../tidydata/exercises/ex_tidy001.html" id="tocId-d61e12185-link">Exercises</a></span></span></li></ul></li></ul></li></ul></div>
                        </nav>
                    
                    
                    <div class="col-lg-9 col-md-9 col-sm-12" id="wh_topic_body">
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="ariaid-title1">
    <h1 class="- topic/title title topictitle1" id="ariaid-title1">Task: Analysis population Benelux</h1>
    
    
    <div class="- topic/body task/taskbody body taskbody"><p class="- topic/shortdesc shortdesc">Unpivot data that is in the crosstab/pivot format.</p>
        <section class="- topic/section task/context section context">
            <p class="- topic/p p">Often data is in the form of cross tables. See the example below, which shows the
                population of men and women in the countries of the Benelux for the years 2000,
                2005, 2010, and 2015.</p>
            <figure class="- topic/fig fig fignone"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure<span class="fig--title-label-number"> 1</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">Cross table with population Benelux</span></figcaption>
                
                <img class="- topic/image image" src="images/benelux_population.png" alt="Cross table with population Benelux" />
            </figure>
            <p class="- topic/p p">You want to analyze this data and, for example, study the development of the
                population per gender per year and possibly even per country. A pivot chart and
                pivot table are best suited for this.</p>
            <p class="- topic/p p">However, the data in the form of a crosstab is not suitable for this, because they
                are not in a well structured Excel table. In this crosstab, the four columns for a
                given year (2000, 2005, 2010, 2015) always contain the same type of data, namely the
                population. This crosstab has four variables: <var class="+ topic/keyword sw-d/varname keyword varname">Country</var>,
                    <var class="+ topic/keyword sw-d/varname keyword varname">Gender</var>, <var class="+ topic/keyword sw-d/varname keyword varname">Year</var>, and
                    <var class="+ topic/keyword sw-d/varname keyword varname">Population</var>.</p>
            <p class="- topic/p p">The first two variables are already in a column, it should stay that way. The last
                four column headings are the values of the variable <var class="+ topic/keyword sw-d/varname keyword varname">Year</var> and the
                content of these columns is the value of the variable <var class="+ topic/keyword sw-d/varname keyword varname">Population</var>.
                The table must therefore first be structured before the analysis can start.</p>
            <div class="- topic/note note note note_note"><span class="note__title">File:</span> <span class="+ topic/ph sw-d/filepath ph filepath">Benelux_Population.xlsx</span></div>
        </section>
        <section class="- topic/ol task/steps ol steps"><ol class="- topic/ol task/steps ol steps"><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Open the practice file.</span>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Select any cell with data and choose <span class="+ topic/ph ui-d/menucascade ph menucascade"><span class="+ topic/ph ui-d/uicontrol ph uicontrol">tab Data</span><abbr title="and then"> &gt; </abbr><span class="+ topic/ph ui-d/uicontrol ph uicontrol">From Table / Range (Get &amp; Transform Data)</span></span>.</span>
                <div class="- topic/itemgroup task/stepresult itemgroup stepresult">
                    <p class="- topic/p p">The <span class="+ topic/keyword ui-d/wintitle keyword wintitle">Create Table</span> dialog box appears, in which the table
                        data can be specified. The data area is already filled in correctly by
                        default.</p>
                </div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Make sure the option for headers is selected and click
                        <span class="+ topic/ph ui-d/uicontrol ph uicontrol">OK</span>.</span>
                <div class="- topic/itemgroup task/stepresult itemgroup stepresult">
                    <p class="- topic/p p">The data on the worksheet is first converted into an Excel table. Then, in a
                        new window, the Power Query Editor is started that reads the data from the
                        table.</p>
                </div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">In the Power Query Editor, select the first two columns, with
                        <var class="+ topic/keyword sw-d/varname keyword varname">Country</var> and <var class="+ topic/keyword sw-d/varname keyword varname">Gender</var>.</span>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Choose <span class="+ topic/ph ui-d/menucascade ph menucascade"><span class="+ topic/ph ui-d/uicontrol ph uicontrol">tab Transform</span><abbr title="and then"> &gt; </abbr><span class="+ topic/ph ui-d/uicontrol ph uicontrol">Unpivot Columns (group Any Column)</span><abbr title="and then"> &gt; </abbr><span class="+ topic/ph ui-d/uicontrol ph uicontrol">Unpivot other Columns</span></span>.</span>
                <div class="- topic/itemgroup task/info itemgroup info">
                    <div class="- topic/note note note note_note"><span class="note__title">Note:</span> An alternative is to select the last four columns with the years and then
                        unpivot these columns. This has the disadvantage that the query no longer
                        works properly when a new column with the population for the year 2020 is
                        added at a later moment in the source data.</div>
                </div>
                <div class="- topic/itemgroup task/stepresult itemgroup stepresult">Two new columns have been created. An <var class="+ topic/keyword sw-d/varname keyword varname">Attribute</var>
                    column (with the values for variable <var class="+ topic/keyword sw-d/varname keyword varname">Year</var>) and a
                        <var class="+ topic/keyword sw-d/varname keyword varname">Value</var> column with the population numbers. And a row is
                    made for each combination of <var class="+ topic/keyword sw-d/varname keyword varname">Country</var>,
                        <var class="+ topic/keyword sw-d/varname keyword varname">Gender</var>, and <var class="+ topic/keyword sw-d/varname keyword varname">Year</var>.</div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Change the names of the columns <var class="+ topic/keyword sw-d/varname keyword varname">Attribute</var> and
                        <var class="+ topic/keyword sw-d/varname keyword varname">Value</var> in respectively <var class="+ topic/keyword sw-d/varname keyword varname">Year</var> and
                        <var class="+ topic/keyword sw-d/varname keyword varname">Population</var>.</span>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Choose<span class="+ topic/ph ui-d/menucascade ph menucascade"><span class="+ topic/ph ui-d/uicontrol ph uicontrol">tab Home</span><abbr title="and then"> &gt; </abbr><span class="+ topic/ph ui-d/uicontrol ph uicontrol">Close &amp; Load (group Close)</span></span></span>
                <div class="- topic/itemgroup task/stepresult itemgroup stepresult">
                    <p class="- topic/p p">The data is now loaded in a new table in a new worksheet.</p>
                    <figure class="- topic/fig fig fignone"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure<span class="fig--title-label-number"> 2</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">Structured data in an Excel table</span></figcaption>
                        
                        <img class="- topic/image image" src="images/benelux_tidy.png" alt="Structured data in an Excel table" />
                    </figure>
                    <p class="- topic/p p">The data is now in a structured Excel table and suitable for creating pivot
                        charts and pivot tables.</p>
                </div>
            </li><li class="- topic/li task/step li step">
                <span class="- topic/ph task/cmd ph cmd">Create the following pivot chart and table.</span>
                <div class="- topic/itemgroup task/stepresult itemgroup stepresult">
                    <figure class="- topic/fig fig fignone"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure<span class="fig--title-label-number"> 3</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">Pivot table and chartof the population per gender per year</span></figcaption>
                        
                        <img class="- topic/image image" src="images/benelux_pivot_chart.png" alt="Pivot table and chartof the population per gender per year" />
                    </figure>
                </div>
            </li></ol></section>
    </div>
</article></main></div>
                        
                        
                        
                        
                    </div>
                    
                </div>
            </div>
        </div> 
        <footer class="navbar navbar-default wh_footer" whc:version="22.1">
  <div class=" footer-container mx-auto ">
    
            Generated by <a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank">
            &lt;oXygen/&gt; XML WebHelp
            </a>
        
  </div>
</footer>
        
        <div id="go2top">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <!-- The modal container for images -->
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <!-- Modal Content (The Image) -->
            <img class="modal-content" id="modal-img" />
            <!-- Modal Caption (Image Text) -->
            <div id="caption"></div>
        </div>
        
        
    </body>
</html>